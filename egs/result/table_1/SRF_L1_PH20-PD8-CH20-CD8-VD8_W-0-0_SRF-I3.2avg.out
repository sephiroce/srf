2020-07-10 22:20:52.960946: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-07-10 22:20:53.903598: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-07-10 22:20:54.670169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.635GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-10 22:20:54.670210: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-07-10 22:20:54.671817: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-07-10 22:20:54.673332: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-07-10 22:20:54.673601: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-07-10 22:20:54.675229: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-07-10 22:20:54.676196: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2020-07-10 22:20:54.679262: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2020-07-10 22:20:54.680498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-07-10 22:20:54.000685: I common_helper.py:233] ********************************************
2020-07-10 22:20:54.000685: I common_helper.py:234]         Settings for Transformer ASR
2020-07-10 22:20:54.000685: I common_helper.py:235] ********************************************
2020-07-10 22:20:54.000685: I common_helper.py:241] . CONFIG
2020-07-10 22:20:54.000685: I common_helper.py:244] - config=samples/conf/sequence_router.conf
2020-07-10 22:20:54.000685: I common_helper.py:241] . DECODING
2020-07-10 22:20:54.000685: I common_helper.py:244] - decoding_beam_width=100
2020-07-10 22:20:54.000685: I common_helper.py:244] - decoding_from_npy=False
2020-07-10 22:20:54.000685: I common_helper.py:244] - decoding_lp_alpha=None
2020-07-10 22:20:54.000685: I common_helper.py:241] . FEAT
2020-07-10 22:20:54.000686: I common_helper.py:244] - feat_dim=123
2020-07-10 22:20:54.000686: I common_helper.py:244] - feat_dim1=None
2020-07-10 22:20:54.000686: I common_helper.py:244] - feat_dim2=None
2020-07-10 22:20:54.000686: I common_helper.py:244] - feat_type=graves13
2020-07-10 22:20:54.000686: I common_helper.py:241] . MODEL
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_ap_decoder=False
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_ap_encdec=False
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_ap_encoder=False
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_ap_scale=None
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_ap_width_stripe=None
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_ap_width_zero=None
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_att_head_num=None
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_average_num=10
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_caps_class_dim=8
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_caps_context=True
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_caps_convolution_dim=8
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_caps_convolution_num=20
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_caps_iter=3
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_caps_layernorm=True
2020-07-10 22:20:54.000686: I common_helper.py:244] - model_caps_norm=1.0
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_primary_dim=8
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_primary_num=20
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_recon=False
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_routing_type=dr
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_seq_type=None
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_stride=1
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_stride_n=2
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_window=1
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_window_even=True
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_window_lpad=0
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_caps_window_rpad=0
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_ckpt_max_to_keep=-1
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_conv_filter_num=64
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_conv_layer_num=2
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_conv_mask_type=0
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_conv_stride=2
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_decoder_num=None
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_dimension=1
2020-07-10 22:20:54.000687: I common_helper.py:244] - model_emb_sqrt=True
2020-07-10 22:20:54.000688: I common_helper.py:244] - model_encoder_num=1
2020-07-10 22:20:54.000688: I common_helper.py:244] - model_initializer=fan_avg
2020-07-10 22:20:54.000688: I common_helper.py:244] - model_inner_dim=None
2020-07-10 22:20:54.000688: I common_helper.py:244] - model_res_dec=1
2020-07-10 22:20:54.000688: I common_helper.py:244] - model_res_enc=1
2020-07-10 22:20:54.000688: I common_helper.py:244] - model_shared_embed=False
2020-07-10 22:20:54.000688: I common_helper.py:244] - model_type=stf
2020-07-10 22:20:54.000688: I common_helper.py:241] . PATH
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_base=/data/timit
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_ckpt=./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_ckpt_epoch=0
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_cmvn_ptrn=None
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_hyp=None
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_test_json=None
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_test_ptrn=tfrecord_graves13/timit-test-None-123-*-of-*
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_train_json=None
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_train_ptrn=tfrecord_graves13/timit-train-None-123-*-of-*
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_valid_json=None
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_valid_ptrn=tfrecord_graves13/timit-valid-None-123-*-of-*
2020-07-10 22:20:54.000688: I common_helper.py:244] - path_vocab=samples/data/timit_61.vocab
2020-07-10 22:20:54.000689: I common_helper.py:244] - path_wrt_tfrecord=None
2020-07-10 22:20:54.000689: I common_helper.py:241] . PREP
2020-07-10 22:20:54.000689: I common_helper.py:244] - prep_data_bos=True
2020-07-10 22:20:54.000689: I common_helper.py:244] - prep_data_name=wsj
2020-07-10 22:20:54.000689: I common_helper.py:244] - prep_data_pad_space=True
2020-07-10 22:20:54.000689: I common_helper.py:244] - prep_data_shard=100
2020-07-10 22:20:54.000689: I common_helper.py:244] - prep_data_unit=word
2020-07-10 22:20:54.000689: I common_helper.py:244] - prep_max_inp=-1
2020-07-10 22:20:54.000689: I common_helper.py:244] - prep_max_tar=-1
2020-07-10 22:20:54.000689: I common_helper.py:241] . TRAIN
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_adam_beta1=0.9
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_adam_beta2=0.98
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_adam_epsilon=1e-09
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_att_dropout=0.1
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_batch_dynamic=True
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_batch_frame=7000
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_batch_size=26
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_ckpt_saving_per=1
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_es_min_delta=0.001
2020-07-10 22:20:54.000689: I common_helper.py:244] - train_es_tolerance=1
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_inn_dropout=0.2
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_inp_dropout=0.2
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_is_mwer=False
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_lr_param_k=1e-06
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_max_epoch=0
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_max_step=0
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_ppl_step=1
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_res_dropout=0.1
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_schedule_prob=None
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_smoothing_confidence=0.0
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_smoothing_type=neighbor
2020-07-10 22:20:54.000690: I common_helper.py:244] - train_warmup_n=1200
2020-07-10 22:20:54.000690: I common_helper.py:245] *********************************************
2020-07-10 22:20:54.000690: C misc_helper.py:93] Last index must be BOS: @, but zh
2020-07-10 22:20:54.000690: I misc_helper.py:106] Decoder Input Dim: 62, Output Dim 62
2020-07-10 22:20:54.000691: I average_ckpt_sr.py:51] The modified output Dimension 63
2020-07-10 22:20:54.724943: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3699850000 Hz
2020-07-10 22:20:54.725707: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5a6e0b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-10 22:20:54.725730: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-10 22:20:54.792563: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5a0fb50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-10 22:20:54.792621: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-10 22:20:54.793448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.635GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-10 22:20:54.793495: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-07-10 22:20:54.793510: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-07-10 22:20:54.793516: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-07-10 22:20:54.793521: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-07-10 22:20:54.793527: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-07-10 22:20:54.793532: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2020-07-10 22:20:54.793538: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2020-07-10 22:20:54.794550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-07-10 22:20:54.794566: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-07-10 22:20:55.136890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-10 22:20:55.136931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2020-07-10 22:20:55.136936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2020-07-10 22:20:55.138163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10072 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:17:00.0, compute capability: 7.5)
2020-07-10 22:20:55.138601: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2020-07-10 22:20:55.000163: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:55.000170: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-191
2020-07-10 22:20:55.000186: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:55.277102: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-07-10 22:20:55.509051: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2020-07-10 22:20:56.000568: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-192
2020-07-10 22:20:56.000590: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:56.000916: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-193
2020-07-10 22:20:56.000942: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:57.000303: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-194
2020-07-10 22:20:57.000319: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:57.000641: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-195
2020-07-10 22:20:57.000662: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:57.000985: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-196
2020-07-10 22:20:58.000007: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:58.000368: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-197
2020-07-10 22:20:58.000392: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:58.000697: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-198
2020-07-10 22:20:58.000719: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:59.000062: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-199
2020-07-10 22:20:59.000083: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:59.000411: I average_ckpt_sr.py:73] ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/ckpt-200
2020-07-10 22:20:59.000433: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:20:59.000771: I average_ckpt_sr.py:87] Total 10 models were loaded.
2020-07-10 22:20:59.000953: I sequence_router.py:176] Layer x 1, Iter x 3, Init CONTEXT, Win 1 (l:0, r:0), Normalized with softmax w/ 1.0 temp
2020-07-10 22:21:00.000060: I average_ckpt_sr.py:117] Saved to ./checkpoint/SRF_L1_PH20-PD8-CH20-CD8-VD8_W-0-0_SRF-I3/avg/ckpt-1
